(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{422:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),a=e.n(c),i=e(85),o=e.n(i),u=e(4),s=e(2),j=e(3),b=e(13),d=e(5),l=Object(c.createContext)(null),f="token",x=function(n){localStorage.setItem(f,n)},O=function(){return localStorage.getItem(f)};function p(){var n=Object(s.a)(["\n  padding: 0 10px;\n  width: 100px;\n  text-align: center;\n  text-decoration: none;\n  cursor: pointer;\n\n  /* &:hover {\n    background-color: #9999aa\n  } */\n\n  ","\n"]);return p=function(){return n},n}function h(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return h=function(){return n},n}function v(){var n=Object(s.a)(["\n  display: flex;\n  height: 100%;\n"]);return v=function(){return n},n}function g(){var n=Object(s.a)(["\n  margin: 0 20px 0 0;\n"]);return g=function(){return n},n}function m(){var n=Object(s.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\n  box-sizing: border-box;\n  padding: 0 32px;\n\n  color: #555;\n  background-color: white;\n\n  /* color: white; */\n  /* background-color: #000035;  */\n  line-height: 64px;\n\n  & * {\n    color: #555;\n    /* border: solid 1px rgba(0, 0, 0, 0.3) */\n  }\n"]);return m=function(){return n},n}var w=j.a.div(m()),y=j.a.h1(g()),S=j.a.div(v()),k=j.a.div(h()),C=Object(j.a)(b.b)(p(),(function(n){return n.$active&&"background: rgba(0, 0, 0, 0.1)"}));var z=function(){var n=Object(d.g)().pathname,t=Object(c.useContext)(l),e=t.user,a=t.setUser,i=t.isGettingUser,o=Object(d.f)();return Object(r.jsxs)(w,{children:[Object(r.jsxs)(S,{children:[Object(r.jsx)(y,{children:"\u90e8\u843d\u683c"}),Object(r.jsxs)(k,{children:[Object(r.jsx)(C,{to:"/",$active:"/"===n,children:"\u9996\u9801"}),Object(r.jsx)(C,{to:"/about",$active:"/about"===n,children:"\u95dc\u65bc"}),!i&&e&&Object(r.jsx)(C,{to:"/new-post",$active:"/new-post"===n,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(k,{children:[!i&&e&&Object(r.jsx)("div",{children:e.username}),!i&&e&&Object(r.jsx)(C,{to:"/",onClick:function(){x(""),o.push("/"),a(null)},children:"\u767b\u51fa"}),!i&&!e&&Object(r.jsx)(C,{to:"/login",$active:"/login"===n,children:"\u767b\u5165"}),!i&&!e&&Object(r.jsx)(C,{to:"/register",$active:"/register"===n,children:"\u8a3b\u518a"})]})]})},U="https://agile-everglades-72905.herokuapp.com";function P(){var n=O();if(n)return fetch("".concat(U,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()})).catch((function(n){console.log(n)}))}function $(){var n=Object(s.a)(["\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white;\n  font-size: 48px;\n  background: rgba(0, 0, 0, 0.5);\n"]);return $=function(){return n},n}function A(){var n=Object(s.a)(["\n  border: none;\n"]);return A=function(){return n},n}function D(){var n=Object(s.a)(["\n  width: 50px;\n  height: 30px;\n  color: #555;;\n  cursor: pointer;\n  text-align: center;\n  line-height: 30px;\n  border: solid 1px #555;\n"]);return D=function(){return n},n}function J(){var n=Object(s.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  & * {\n    margin: 0 10px;\n  }\n"]);return J=function(){return n},n}function _(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.6);\n"]);return _=function(){return n},n}function E(){var n=Object(s.a)(["\n  font-size: 20px;\n  max-width: 360px;\n  overflow: hidden;\n  cursor: pointer;\n  color: #555;\n  text-decoration: none;\n  word-break: break-word;\n"]);return E=function(){return n},n}function L(){var n=Object(s.a)(["\n  margin: 0 auto;\n  padding: 16px;\n  width: 600px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  border-bottom: solid 1px rgba(0, 0, 0, 0.2);\n"]);return L=function(){return n},n}function N(){var n=Object(s.a)([""]);return N=function(){return n},n}var T=j.a.div(N()),B=j.a.div(L()),I=Object(j.a)(b.b)(E()),G=j.a.div(_()),M=j.a.div(J()),R=j.a.div(D()),X=Object(j.a)(R)(A()),q=j.a.div($());function F(n){var t=n.post;return Object(r.jsxs)(B,{children:[Object(r.jsx)(I,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(G,{children:new Date(t.createdAt).toLocaleString()})]})}var H=function(){var n=Object(c.useState)([]),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(0),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Object(c.useState)(1),d=Object(u.a)(b,2),l=d[0],f=d[1],x=Object(c.useState)(!0),O=Object(u.a)(x,2),p=O[0],h=O[1],v=Object(c.useState)(0),g=Object(u.a)(v,2),m=g[0],w=g[1];return Object(c.useEffect)((function(){(function(n){return fetch("".concat(U,"/posts?_sort=createdAt&_order=desc&_start=").concat(n,"&_end=").concat(n+5)).then((function(n){return n}))})(s).then((function(n){return w(Math.ceil(n.headers.get("X-Total-Count")/5)),n.json()})).then((function(n){a(n),h(!1)}))}),[s]),Object(r.jsxs)(T,{children:[p&&Object(r.jsx)(q,{children:"Loading..."}),!p&&e.map((function(n){return Object(r.jsx)(F,{post:n},n.id)})),!p&&Object(r.jsxs)(M,{children:[Object(r.jsx)(R,{onClick:function(){j(0),f(1)},children:"<<"}),Object(r.jsx)(R,{onClick:function(){l<=1||(j(s-5),f(l-1))},children:"<"}),Object(r.jsx)(X,{children:"".concat(l," / ").concat(m)}),Object(r.jsx)(R,{onClick:function(){l>=m||(j(s+5),f(l+1))},children:">"}),Object(r.jsx)(R,{onClick:function(){j(5*(m-1)),f(m)},children:">>"})]})]})};function K(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return K=function(){return n},n}function Q(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return Q=function(){return n},n}function V(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return V=function(){return n},n}function W(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return W=function(){return n},n}var Y=j.a.form(W()),Z=j.a.div(V()),nn=j.a.div(Q()),tn=j.a.button(K());var en=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(""),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Object(c.useState)(""),f=Object(u.a)(b,2),O=f[0],p=f[1],h=Object(c.useState)(""),v=Object(u.a)(h,2),g=v[0],m=v[1],w=Object(d.f)(),y=Object(c.useContext)(l).setUser;return Object(r.jsxs)(Y,{onSubmit:function(n){n.preventDefault(),function(n){var t=n.username,e=n.nickname,r=n.password;return fetch("".concat(U,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:e,username:t,password:r})}).then((function(n){return n.json()}))}({username:e,nickname:s,password:O}).then((function(n){if(0===n.ok)return m(n.message);m(null),console.log(n);var t=n.token;x(t),P().then((function(n){if(console.log(n),1!==n.ok)return x(null),m(n.toString());y(n.data),w.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u8a3b\u518a"}),Object(r.jsxs)(Z,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){a(n.target.value)}})]}),Object(r.jsxs)(Z,{children:["Nickname:",Object(r.jsx)("input",{type:"text",name:"nickname",value:s,onChange:function(n){j(n.target.value)}})]}),Object(r.jsxs)(Z,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:O,onChange:function(n){p(n.target.value)}})]}),g&&Object(r.jsx)(nn,{children:g}),Object(r.jsx)(tn,{type:"submit",children:"\u8a3b\u518a"})]})};function rn(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return rn=function(){return n},n}function cn(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return cn=function(){return n},n}function an(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return an=function(){return n},n}function on(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return on=function(){return n},n}var un=j.a.form(on()),sn=j.a.div(an()),jn=j.a.div(cn()),bn=j.a.button(rn());var dn=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(""),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Object(c.useState)(""),f=Object(u.a)(b,2),O=f[0],p=f[1],h=Object(d.f)(),v=Object(c.useContext)(l).setUser;return Object(r.jsxs)(un,{onSubmit:function(n){n.preventDefault(),function(n,t){return fetch("".concat(U,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(0===n.ok)return p(n.message);p(null);var t=n.token;x(t),P().then((function(n){if(console.log(n),1!==n.ok)return x(null),p(n.toString());v(n.data),h.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u767b\u5165"}),Object(r.jsxs)(sn,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){a(n.target.value)}})]}),Object(r.jsxs)(sn,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:s,onChange:function(n){j(n.target.value)}})]}),O&&Object(r.jsx)(jn,{children:O}),Object(r.jsx)(bn,{type:"submit",children:"\u767b\u5165"})]})},ln=e(89),fn=e.n(ln),xn=e(426),On=e(425);function pn(){var n=Object(s.a)(["\n  width: 100%;\n"]);return pn=function(){return n},n}function hn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  white-space: pre-wrap;\n"]);return hn=function(){return n},n}function vn(){var n=Object(s.a)([""]);return vn=function(){return n},n}function gn(){var n=Object(s.a)(["\n  margin: 10px 10px 0 0;\n  font-size: 16px;\n  color: #aaa;\n"]);return gn=function(){return n},n}function mn(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return mn=function(){return n},n}function wn(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return wn=function(){return n},n}function yn(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return yn=function(){return n},n}function Sn(){var n=Object(s.a)(["\n  width: 800px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return Sn=function(){return n},n}function kn(){var n=Object(s.a)([""]);return kn=function(){return n},n}var Cn=j.a.div(kn()),zn=j.a.div(Sn()),Un=j.a.div(yn()),Pn=j.a.div(wn()),$n=j.a.div(mn()),An=j.a.div(gn()),Dn=Object(j.a)(An)(vn()),Jn=j.a.div(hn()),_n=j.a.img(pn()),En={code:function(n){n.language;var t=n.value;return Object(r.jsx)(xn.a,{style:On.a,language:"javascript",children:t})},image:function(n){n.alt;var t=n.src;n.title;return Object(r.jsx)(_n,{src:t})}};var Ln=function(){var n=Object(c.useState)({}),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(null),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Object(d.h)().id;return Object(c.useEffect)((function(){(function(n){return fetch("".concat(U,"/posts/").concat(n,"/?_expand=user")).then((function(n){return n.json()}))})(b).then((function(n){a(n),j(n.user.nickname)}))}),[]),Object(r.jsx)(Cn,{children:Object(r.jsxs)(zn,{children:[Object(r.jsxs)(Un,{children:[Object(r.jsx)(Pn,{children:e.title}),Object(r.jsxs)($n,{children:[s&&Object(r.jsx)(An,{children:"\u4f5c\u8005\uff1a".concat(s)}),Object(r.jsx)(Dn,{children:e.createdAt&&new Date(e.createdAt).toLocaleString()})]})]}),Object(r.jsx)(Jn,{children:Object(r.jsx)(fn.a,{source:e.body,renderers:En})})]})})};function Nn(){var n=Object(s.a)([""]);return Nn=function(){return n},n}function Tn(){var n=Object(s.a)(["\n  text-align: right;\n"]);return Tn=function(){return n},n}function Bn(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n  font-size: 16px;\n  color: red;\n"]);return Bn=function(){return n},n}function In(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  height: 400px;\n  box-sizing: border-box;\n  resize: vertical;\n"]);return In=function(){return n},n}function Gn(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  box-sizing: border-box;\n"]);return Gn=function(){return n},n}function Mn(){var n=Object(s.a)(["\n  padding: 20px 0;\n"]);return Mn=function(){return n},n}function Rn(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n"]);return Rn=function(){return n},n}function Xn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  font-size: 36px;\n  color: #333;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n"]);return Xn=function(){return n},n}function qn(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return qn=function(){return n},n}function Fn(){var n=Object(s.a)([""]);return Fn=function(){return n},n}var Hn=j.a.div(Fn()),Kn=j.a.div(qn()),Qn=j.a.div(Xn()),Vn=j.a.div(Rn()),Wn=j.a.form(Mn()),Yn=j.a.input(Gn()),Zn=j.a.textarea(In()),nt=j.a.div(Bn()),tt=j.a.div(Tn()),et=j.a.button(Nn());var rt=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(""),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Object(c.useState)(""),l=Object(u.a)(b,2),f=l[0],x=l[1],p=Object(d.f)();return Object(r.jsx)(Hn,{children:Object(r.jsxs)(Kn,{children:[Object(r.jsx)(Qn,{children:"\u767c\u5e03\u6587\u7ae0"}),Object(r.jsxs)(Wn,{onSubmit:function(n){n.preventDefault(),console.log(e,s),function(n,t){var e=O();return fetch("".concat(U,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({title:n,body:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(console.log(n),0===n.ok)return x(n.message);p.push("/")}))},children:[Object(r.jsx)(Vn,{children:"\u6587\u7ae0\u6a19\u984c\uff1a"}),Object(r.jsx)(Yn,{value:e,onChange:function(n){a(n.target.value)}}),Object(r.jsx)(Vn,{children:"\u6587\u7ae0\u5167\u5bb9\uff1a"}),Object(r.jsx)(Zn,{value:s,onChange:function(n){j(n.target.value)}}),Object(r.jsxs)(tt,{children:[f&&Object(r.jsx)(nt,{children:f}),Object(r.jsx)(et,{children:"\u767c\u5e03"})]})]})]})})};function ct(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  word-break: break-word;\n"]);return ct=function(){return n},n}function at(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return at=function(){return n},n}function it(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return it=function(){return n},n}function ot(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return ot=function(){return n},n}function ut(){var n=Object(s.a)([""]);return ut=function(){return n},n}var st=j.a.div(ut()),jt=j.a.div(ot()),bt=j.a.div(it()),dt=j.a.div(at()),lt=j.a.div(ct());var ft=function(){return Object(r.jsx)(st,{children:Object(r.jsxs)(jt,{children:[Object(r.jsx)(bt,{children:Object(r.jsx)(dt,{children:"About"})}),Object(r.jsx)(lt,{children:"Lidemy React homework - blog"})]})})};function xt(){var n=Object(s.a)(["\n  padding-top: 64px;\n"]);return xt=function(){return n},n}var Ot=j.a.div(xt());var pt=function(){var n=Object(c.useState)(null),t=Object(u.a)(n,2),e=t[0],a=t[1],i=Object(c.useState)(!0),o=Object(u.a)(i,2),s=o[0],j=o[1];return Object(c.useEffect)((function(){O()?P().then((function(n){n.ok&&(a(n.data),j(!1))})):j(!1)}),[]),Object(r.jsx)(l.Provider,{value:{user:e,setUser:a,isGettingUser:s},children:Object(r.jsx)(Ot,{children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(z,{}),Object(r.jsxs)(d.c,{children:[Object(r.jsx)(d.a,{exact:!0,path:"/",children:Object(r.jsx)(H,{})}),Object(r.jsx)(d.a,{path:"/register",children:Object(r.jsx)(en,{})}),Object(r.jsx)(d.a,{path:"/login",children:Object(r.jsx)(dn,{})}),Object(r.jsx)(d.a,{path:"/posts/:id",children:Object(r.jsx)(Ln,{})}),Object(r.jsx)(d.a,{path:"/new-post",children:Object(r.jsx)(rt,{})}),Object(r.jsx)(d.a,{path:"/about",children:Object(r.jsx)(ft,{})})]})]})})})};o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(pt,{})}),document.getElementById("root"))}},[[422,1,2]]]);
//# sourceMappingURL=main.4fa8d915.chunk.js.map