(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{35:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),i=e.n(c),a=e(20),o=e.n(a),u=e(4),s=e(2),j=e(3),b=e(10),d=e(5),l=Object(c.createContext)(null),x="token",f=function(n){localStorage.setItem(x,n)},O=function(){return localStorage.getItem(x)};function p(){var n=Object(s.a)(["\n  padding: 0 10px;\n  width: 100px;\n  text-align: center;\n  text-decoration: none;\n  cursor: pointer;\n\n  /* &:hover {\n    background-color: #9999aa\n  } */\n\n  ","\n"]);return p=function(){return n},n}function h(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return h=function(){return n},n}function v(){var n=Object(s.a)(["\n  display: flex;\n  height: 100%;\n"]);return v=function(){return n},n}function g(){var n=Object(s.a)(["\n  margin: 0 20px 0 0;\n"]);return g=function(){return n},n}function m(){var n=Object(s.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\n  box-sizing: border-box;\n  padding: 0 32px;\n\n  color: #555;\n  background-color: white;\n\n  /* color: white; */\n  /* background-color: #000035;  */\n  line-height: 64px;\n\n  & * {\n    color: #555;\n    /* border: solid 1px rgba(0, 0, 0, 0.3) */\n  }\n"]);return m=function(){return n},n}var w=j.a.div(m()),y=j.a.h1(g()),S=j.a.div(v()),k=j.a.div(h()),C=Object(j.a)(b.b)(p(),(function(n){return n.$active&&"background: rgba(0, 0, 0, 0.1)"}));var z=function(){var n=Object(d.g)().pathname,t=Object(c.useContext)(l),e=t.user,i=t.setUser,a=t.isGettingUser,o=Object(d.f)();return Object(r.jsxs)(w,{children:[Object(r.jsxs)(S,{children:[Object(r.jsx)(y,{children:"\u90e8\u843d\u683c"}),Object(r.jsxs)(k,{children:[Object(r.jsx)(C,{to:"/",$active:"/"===n,children:"\u9996\u9801"}),Object(r.jsx)(C,{to:"/about",$active:"/about"===n,children:"\u95dc\u65bc"}),!a&&e&&Object(r.jsx)(C,{to:"/new-post",$active:"/new-post"===n,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(k,{children:[!a&&e&&Object(r.jsx)("div",{children:e.username}),!a&&e&&Object(r.jsx)(C,{to:"/",onClick:function(){f(""),o.push("/"),i(null)},children:"\u767b\u51fa"}),!a&&!e&&Object(r.jsx)(C,{to:"/login",$active:"/login"===n,children:"\u767b\u5165"}),!a&&!e&&Object(r.jsx)(C,{to:"/register",$active:"/register"===n,children:"\u8a3b\u518a"})]})]})},U="https://student-json-api.lidemy.me";function P(){var n=O();if(n)return fetch("".concat(U,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()})).catch((function(n){console.log(n)}))}function $(){var n=Object(s.a)(["\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white;\n  font-size: 48px;\n  background: rgba(0, 0, 0, 0.5);\n"]);return $=function(){return n},n}function A(){var n=Object(s.a)(["\n  border: none;\n"]);return A=function(){return n},n}function D(){var n=Object(s.a)(["\n  width: 50px;\n  height: 30px;\n  color: #555;;\n  cursor: pointer;\n  text-align: center;\n  line-height: 30px;\n  border: solid 1px #555;\n"]);return D=function(){return n},n}function J(){var n=Object(s.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  & * {\n    margin: 0 10px;\n  }\n"]);return J=function(){return n},n}function _(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.6);\n"]);return _=function(){return n},n}function E(){var n=Object(s.a)(["\n  font-size: 20px;\n  max-width: 360px;\n  overflow: hidden;\n  cursor: pointer;\n  color: #555;\n  text-decoration: none;\n  word-break: break-word;\n"]);return E=function(){return n},n}function L(){var n=Object(s.a)(["\n  margin: 0 auto;\n  padding: 16px;\n  width: 600px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  border-bottom: solid 1px rgba(0, 0, 0, 0.2);\n"]);return L=function(){return n},n}function N(){var n=Object(s.a)([""]);return N=function(){return n},n}var T=j.a.div(N()),B=j.a.div(L()),I=Object(j.a)(b.b)(E()),G=j.a.div(_()),M=j.a.div(J()),R=j.a.div(D()),X=Object(j.a)(R)(A()),q=j.a.div($());function F(n){var t=n.post;return Object(r.jsxs)(B,{children:[Object(r.jsx)(I,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(G,{children:new Date(t.createdAt).toLocaleString()})]})}var H=function(){var n=Object(c.useState)([]),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(0),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(1),d=Object(u.a)(b,2),l=d[0],x=d[1],f=Object(c.useState)(!0),O=Object(u.a)(f,2),p=O[0],h=O[1],v=Object(c.useState)(0),g=Object(u.a)(v,2),m=g[0],w=g[1];return Object(c.useEffect)((function(){(function(n){return fetch("".concat(U,"/posts?_sort=createdAt&_order=desc&_start=").concat(n,"&_end=").concat(n+5)).then((function(n){return n}))})(s).then((function(n){return w(Math.ceil(n.headers.get("X-Total-Count")/5)),n.json()})).then((function(n){i(n),h(!1)}))}),[s]),Object(r.jsxs)(T,{children:[p&&Object(r.jsx)(q,{children:"Loading..."}),!p&&e.map((function(n){return Object(r.jsx)(F,{post:n},n.id)})),!p&&Object(r.jsxs)(M,{children:[Object(r.jsx)(R,{onClick:function(){j(0),x(1)},children:"<<"}),Object(r.jsx)(R,{onClick:function(){l<=1||(j(s-5),x(l-1))},children:"<"}),Object(r.jsx)(X,{children:"".concat(l," / ").concat(m)}),Object(r.jsx)(R,{onClick:function(){l>=m||(j(s+5),x(l+1))},children:">"}),Object(r.jsx)(R,{onClick:function(){j(5*(m-1)),x(m)},children:">>"})]})]})};function K(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return K=function(){return n},n}function Q(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return Q=function(){return n},n}function V(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return V=function(){return n},n}function W(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return W=function(){return n},n}var Y=j.a.form(W()),Z=j.a.div(V()),nn=j.a.div(Q()),tn=j.a.button(K());var en=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),x=Object(u.a)(b,2),O=x[0],p=x[1],h=Object(c.useState)(""),v=Object(u.a)(h,2),g=v[0],m=v[1],w=Object(d.f)(),y=Object(c.useContext)(l).setUser;return Object(r.jsxs)(Y,{onSubmit:function(n){n.preventDefault(),function(n){var t=n.username,e=n.nickname,r=n.password;return fetch("".concat(U,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:e,username:t,password:r})}).then((function(n){return n.json()}))}({username:e,nickname:s,password:O}).then((function(n){if(0===n.ok)return m(n.message);m(null),console.log(n);var t=n.token;f(t),P().then((function(n){if(console.log(n),1!==n.ok)return f(null),m(n.toString());y(n.data),w.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u8a3b\u518a"}),Object(r.jsxs)(Z,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){i(n.target.value)}})]}),Object(r.jsxs)(Z,{children:["Nickname:",Object(r.jsx)("input",{type:"text",name:"nickname",value:s,onChange:function(n){j(n.target.value)}})]}),Object(r.jsxs)(Z,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:O,onChange:function(n){p(n.target.value)}})]}),g&&Object(r.jsx)(nn,{children:g}),Object(r.jsx)(tn,{type:"submit",children:"\u8a3b\u518a"})]})};function rn(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return rn=function(){return n},n}function cn(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return cn=function(){return n},n}function an(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return an=function(){return n},n}function on(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return on=function(){return n},n}var un=j.a.form(on()),sn=j.a.div(an()),jn=j.a.div(cn()),bn=j.a.button(rn());var dn=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),x=Object(u.a)(b,2),O=x[0],p=x[1],h=Object(d.f)(),v=Object(c.useContext)(l).setUser;return Object(r.jsxs)(un,{onSubmit:function(n){n.preventDefault(),function(n,t){return fetch("".concat(U,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(0===n.ok)return p(n.message);p(null);var t=n.token;f(t),P().then((function(n){if(console.log(n),1!==n.ok)return f(null),p(n.toString());v(n.data),h.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u767b\u5165"}),Object(r.jsxs)(sn,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){i(n.target.value)}})]}),Object(r.jsxs)(sn,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:s,onChange:function(n){j(n.target.value)}})]}),O&&Object(r.jsx)(jn,{children:O}),Object(r.jsx)(bn,{type:"submit",children:"\u767b\u5165"})]})};function ln(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  word-break: break-word;\n"]);return ln=function(){return n},n}function xn(){var n=Object(s.a)([""]);return xn=function(){return n},n}function fn(){var n=Object(s.a)(["\n  margin: 10px 10px 0 0;\n  font-size: 16px;\n  color: #aaa;\n"]);return fn=function(){return n},n}function On(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return On=function(){return n},n}function pn(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return pn=function(){return n},n}function hn(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return hn=function(){return n},n}function vn(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return vn=function(){return n},n}function gn(){var n=Object(s.a)([""]);return gn=function(){return n},n}var mn=j.a.div(gn()),wn=j.a.div(vn()),yn=j.a.div(hn()),Sn=j.a.div(pn()),kn=j.a.div(On()),Cn=j.a.div(fn()),zn=Object(j.a)(Cn)(xn()),Un=j.a.div(ln());var Pn=function(){var n=Object(c.useState)({}),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(null),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(d.h)().id;return Object(c.useEffect)((function(){(function(n){return fetch("".concat(U,"/posts/").concat(n,"/?_expand=user")).then((function(n){return n.json()}))})(b).then((function(n){i(n),j(n.user.nickname)}))}),[]),Object(r.jsx)(mn,{children:Object(r.jsxs)(wn,{children:[Object(r.jsxs)(yn,{children:[Object(r.jsx)(Sn,{children:e.title}),Object(r.jsxs)(kn,{children:[s&&Object(r.jsx)(Cn,{children:"\u4f5c\u8005\uff1a".concat(s)}),Object(r.jsx)(zn,{children:e.createdAt&&new Date(e.createdAt).toLocaleString()})]})]}),Object(r.jsx)(Un,{children:e.body})]})})};function $n(){var n=Object(s.a)([""]);return $n=function(){return n},n}function An(){var n=Object(s.a)(["\n  text-align: right;\n"]);return An=function(){return n},n}function Dn(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n  font-size: 16px;\n  color: red;\n"]);return Dn=function(){return n},n}function Jn(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  height: 400px;\n  box-sizing: border-box;\n  resize: vertical;\n"]);return Jn=function(){return n},n}function _n(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  box-sizing: border-box;\n"]);return _n=function(){return n},n}function En(){var n=Object(s.a)(["\n  padding: 20px 0;\n"]);return En=function(){return n},n}function Ln(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n"]);return Ln=function(){return n},n}function Nn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  font-size: 36px;\n  color: #333;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n"]);return Nn=function(){return n},n}function Tn(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return Tn=function(){return n},n}function Bn(){var n=Object(s.a)([""]);return Bn=function(){return n},n}var In=j.a.div(Bn()),Gn=j.a.div(Tn()),Mn=j.a.div(Nn()),Rn=j.a.div(Ln()),Xn=j.a.form(En()),qn=j.a.input(_n()),Fn=j.a.textarea(Jn()),Hn=j.a.div(Dn()),Kn=j.a.div(An()),Qn=j.a.button($n());var Vn=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),l=Object(u.a)(b,2),x=l[0],f=l[1],p=Object(d.f)();return Object(r.jsx)(In,{children:Object(r.jsxs)(Gn,{children:[Object(r.jsx)(Mn,{children:"\u767c\u5e03\u6587\u7ae0"}),Object(r.jsxs)(Xn,{onSubmit:function(n){n.preventDefault(),console.log(e,s),function(n,t){var e=O();return fetch("".concat(U,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({title:n,body:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(console.log(n),0===n.ok)return f(n.message);p.push("/")}))},children:[Object(r.jsx)(Rn,{children:"\u6587\u7ae0\u6a19\u984c\uff1a"}),Object(r.jsx)(qn,{value:e,onChange:function(n){i(n.target.value)}}),Object(r.jsx)(Rn,{children:"\u6587\u7ae0\u5167\u5bb9\uff1a"}),Object(r.jsx)(Fn,{value:s,onChange:function(n){j(n.target.value)}}),Object(r.jsxs)(Kn,{children:[x&&Object(r.jsx)(Hn,{children:x}),Object(r.jsx)(Qn,{children:"\u767c\u5e03"})]})]})]})})};function Wn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  word-break: break-word;\n"]);return Wn=function(){return n},n}function Yn(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return Yn=function(){return n},n}function Zn(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return Zn=function(){return n},n}function nt(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return nt=function(){return n},n}function tt(){var n=Object(s.a)([""]);return tt=function(){return n},n}var et=j.a.div(tt()),rt=j.a.div(nt()),ct=j.a.div(Zn()),it=j.a.div(Yn()),at=j.a.div(Wn());var ot=function(){return Object(r.jsx)(et,{children:Object(r.jsxs)(rt,{children:[Object(r.jsx)(ct,{children:Object(r.jsx)(it,{children:"About"})}),Object(r.jsx)(at,{children:"Lidemy React homework - blog"})]})})};function ut(){var n=Object(s.a)(["\n  padding-top: 64px;\n"]);return ut=function(){return n},n}var st=j.a.div(ut());var jt=function(){var n=Object(c.useState)(null),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(!0),o=Object(u.a)(a,2),s=o[0],j=o[1];return Object(c.useEffect)((function(){O()?P().then((function(n){n.ok&&(i(n.data),j(!1))})):j(!1)}),[]),Object(r.jsx)(l.Provider,{value:{user:e,setUser:i,isGettingUser:s},children:Object(r.jsx)(st,{children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(z,{}),Object(r.jsxs)(d.c,{children:[Object(r.jsx)(d.a,{exact:!0,path:"/",children:Object(r.jsx)(H,{})}),Object(r.jsx)(d.a,{path:"/register",children:Object(r.jsx)(en,{})}),Object(r.jsx)(d.a,{path:"/login",children:Object(r.jsx)(dn,{})}),Object(r.jsx)(d.a,{path:"/posts/:id",children:Object(r.jsx)(Pn,{})}),Object(r.jsx)(d.a,{path:"/new-post",children:Object(r.jsx)(Vn,{})}),Object(r.jsx)(d.a,{path:"/about",children:Object(r.jsx)(ot,{})})]})]})})})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(jt,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.05e19ce5.chunk.js.map