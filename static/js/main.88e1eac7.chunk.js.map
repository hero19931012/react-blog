{"version":3,"sources":["contexts.js","utils.js","components/Header/Header.js","WebAPI.js","pages/HomePage/HomePage.js","pages/RegisterPage/RegisterPage.js","pages/LoginPage/LoginPage.js","pages/PostPage/PostPage.js","pages/NewPostPage/NewPostPage.js","pages/AboutPage/AboutPage.js","components/App/App.js","index.js"],"names":["AuthContext","createContext","TOKEN_NAME","setAuthToken","token","localStorage","setItem","getAuthToken","getItem","HeaderContainer","styled","div","Brand","h1","NavLeftContainer","NavbarList","Nav","Link","props","$active","Header","pathname","useLocation","useContext","user","setUser","isGettingUser","history","useHistory","to","username","onClick","push","BASE_URL","getMe","fetch","headers","authorization","then","res","json","catch","err","console","log","Root","PostContainer","PostTitle","PostDate","PageControllerContainer","PageController","CurrentPage","Loading","Post","post","id","title","Date","createdAt","toLocaleString","HomePage","useState","posts","setPosts","offset","setOffset","currentPage","setCurrentPage","isGettingPosts","setIsGettingPosts","totalPageCount","setTotalPageCount","useEffect","getPosts","Math","ceil","get","map","RegisterForm","form","RegisterInputContainer","ErrorMessage","SubmitButton","button","RegisterPage","setUsername","nickname","setNickname","password","setPassword","errorMessage","setErrorMessage","onSubmit","e","preventDefault","method","body","JSON","stringify","register","data","ok","message","response","toString","type","name","value","onChange","target","LoginForm","LoginInputContainer","LoginPage","login","PostHeader","PostInfoContainer","PostAuthor","PostTime","PostContent","Img","img","renderers","code","language","style","cb","children","image","alt","src","PostPage","setPost","author","setAuthor","useParams","getPost","source","NewPostContainer","PageTitle","InputTitle","NewPostForm","NewPostTitle","input","NewPostContent","textarea","NewPostSubmitButtonContainer","NewPostSubmitButton","NewPostPage","setTitle","content","setContent","addPost","AboutContainer","AboutHeader","AboutTitle","AboutContent","AboutPage","App","setIsGettingUser","Provider","exact","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.88e1eac7.chunk.js","sourcesContent":["import { createContext } from 'react';\r\n\r\nexport const AuthContext = createContext(null);\r\n","const TOKEN_NAME = 'token';\r\n\r\nexport const setAuthToken = (token) => {\r\n  localStorage.setItem(TOKEN_NAME, token);\r\n};\r\n\r\nexport const getAuthToken = () => localStorage.getItem(TOKEN_NAME);\r\n","import { useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link, useLocation, useHistory } from \"react-router-dom\";\r\nimport { AuthContext } from '../../contexts'\r\nimport { setAuthToken } from '../../utils'\r\n\r\nconst HeaderContainer = styled.div`\r\n  height: 64px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  position: fixed;\r\n  top: 0px;\r\n  left: 0px;\r\n  right: 0px;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\r\n  box-sizing: border-box;\r\n  padding: 0 32px;\r\n\r\n  color: #555;\r\n  background-color: white;\r\n  line-height: 64px;\r\n\r\n  & * {\r\n    color: #555;\r\n  }\r\n`\r\n\r\nconst Brand = styled.h1`\r\n  margin: 0 20px 0 0;\r\n`\r\nconst NavLeftContainer = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n`\r\nconst NavbarList = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`\r\nconst Nav = styled(Link)`\r\n  padding: 0 10px;\r\n  width: 100px;\r\n  text-align: center;\r\n  text-decoration: none;\r\n  cursor: pointer;\r\n  ${props => props.$active && `background: rgba(0, 0, 0, 0.1)`}\r\n`\r\n\r\nfunction Header() {\r\n  const location = useLocation()\r\n  const { pathname } = location\r\n  const { user, setUser, isGettingUser } = useContext(AuthContext)\r\n  const history = useHistory();\r\n\r\n  function handleLogout() {\r\n    setAuthToken('');\r\n    history.push('/');\r\n    setUser(null);\r\n  }\r\n\r\n  return (\r\n    <HeaderContainer>\r\n      <NavLeftContainer>\r\n        <Brand>部落格</Brand>\r\n        <NavbarList>\r\n          <Nav to=\"/\" $active={pathname === '/'}>首頁</Nav>\r\n          <Nav to=\"/about\" $active={pathname === '/about'}>關於</Nav>\r\n          {!isGettingUser && user && <Nav to=\"/new-post\" $active={pathname === '/new-post'}>發布文章</Nav>}\r\n        </NavbarList>\r\n      </NavLeftContainer>\r\n\r\n      <NavbarList>\r\n        {!isGettingUser && user && <div>{user.username}</div>}\r\n        {!isGettingUser && user && <Nav to=\"/\" onClick={handleLogout}>登出</Nav>}\r\n        {!isGettingUser && !user && <Nav to=\"/login\" $active={pathname === '/login'}>登入</Nav>\r\n        }\r\n        {!isGettingUser && !user && <Nav to=\"/register\" $active={pathname === '/register'}>註冊</Nav>\r\n        }\r\n      </NavbarList>\r\n\r\n    </HeaderContainer>\r\n  );\r\n}\r\n\r\n\r\nexport default Header;\r\n","import { getAuthToken } from './utils';\r\n\r\nconst BASE_URL = 'https://agile-everglades-72905.herokuapp.com';\r\n\r\nexport function register({ username, nickname, password }) {\r\n  return fetch(`${BASE_URL}/register`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({\r\n      nickname,\r\n      username,\r\n      password,\r\n    }),\r\n  })\r\n    .then(res => res.json());\r\n}\r\n\r\nexport function getPosts(offset) {\r\n  return fetch(`${BASE_URL}/posts?_sort=createdAt&_order=desc&_start=${offset}&_end=${offset + 5}`)\r\n    // 由於不是直接 return res.json() 的話就不會自動 json.parse()\r\n    // 所以到後面再 parse\r\n    .then(res => res);\r\n}\r\n\r\nexport function getPost(id) {\r\n  return fetch(`${BASE_URL}/posts/${id}/?_expand=user`)\r\n    .then(res => res.json());\r\n}\r\n\r\nexport function login(username, password) {\r\n  return fetch(`${BASE_URL}/login`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({\r\n      username,\r\n      password,\r\n    }),\r\n  })\r\n    .then(res => res.json());\r\n}\r\n\r\nexport function getMe() {\r\n  const token = getAuthToken();\r\n  if (token) {\r\n    return fetch(`${BASE_URL}/me`, {\r\n      headers: {\r\n        // get token from localStorage\r\n        authorization: `Bearer ${token}`,\r\n      },\r\n    })\r\n      .then(res => res.json())\r\n      .catch(err => { console.log(err) })\r\n  }\r\n}\r\n\r\nexport function addPost(title, body) {\r\n  const token = getAuthToken();\r\n  return fetch(`${BASE_URL}/posts`, {\r\n    method: 'POST',\r\n    headers: {\r\n      authorization: `Bearer ${token}`,\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({\r\n      title,\r\n      body,\r\n    }),\r\n  })\r\n    .then(res => res.json());\r\n}\r\n\r\nexport function deletePost(id) {\r\n  const token = getAuthToken();\r\n  return fetch(`${BASE_URL}/posts/${id}`, {\r\n    method: 'DELETE',\r\n    headers: {\r\n      authorization: `Bearer ${token}`,\r\n      'content-type': 'application/json',\r\n    },\r\n  })\r\n    .then(res => res.json());\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from \"react-router-dom\";\r\nimport { getPosts } from '../../WebAPI'\r\n\r\nconst Root = styled.div``\r\nconst PostContainer = styled.div`\r\n  margin: 0 auto;\r\n  padding: 16px;\r\n  width: 800px;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  justify-content: space-between;\r\n  border-bottom: solid 1px rgba(0, 0, 0, 0.2);\r\n`\r\nconst PostTitle = styled(Link)`\r\n  font-size: 20px;\r\n  max-width: 360px;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n  color: #555;\r\n  text-decoration: none;\r\n  word-break: break-word;\r\n`\r\nconst PostDate = styled.div`\r\n  font-size: 16px;\r\n  color: rgba(0, 0, 0, 0.6);\r\n`\r\n\r\nconst PageControllerContainer = styled.div`\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n  & * {\r\n    margin: 0 10px;\r\n  }\r\n`\r\nconst PageController = styled.div`\r\n  width: 50px;\r\n  height: 30px;\r\n  color: #555;;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  line-height: 30px;\r\n  border: solid 1px #555;\r\n`\r\n\r\nconst CurrentPage = styled(PageController)`\r\n  border: none;\r\n`\r\n\r\nconst Loading = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  left: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: white;\r\n  font-size: 48px;\r\n  background: rgba(0, 0, 0, 0.5);\r\n`\r\n\r\nfunction Post({ post }) {\r\n  return (\r\n    <PostContainer>\r\n      <PostTitle to={`/posts/${post.id}`}>{post.title}</PostTitle>\r\n      <PostDate>{new Date(post.createdAt).toLocaleString()}</PostDate>\r\n    </PostContainer>\r\n  )\r\n}\r\n\r\nPost.propTypes = {\r\n  post: PropTypes.object,\r\n}\r\n\r\nfunction HomePage() {\r\n  const [posts, setPosts] = useState([])\r\n  const [offset, setOffset] = useState(0)\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  const [isGettingPosts, setIsGettingPosts] = useState(true)\r\n  const [totalPageCount, setTotalPageCount] = useState(0)\r\n\r\n  useEffect(() => {\r\n    getPosts(offset).then((res) => {\r\n      setTotalPageCount(Math.ceil(res.headers.get('X-Total-Count') / 5));\r\n      return res.json()\r\n    }).then((posts) => {\r\n      setPosts(posts);\r\n      setIsGettingPosts(false);\r\n    })\r\n  }, [offset])\r\n\r\n  return (\r\n    <Root>\r\n      {isGettingPosts && <Loading>Loading...</Loading>}\r\n      { !isGettingPosts\r\n        && posts\r\n          .map(post => <Post post={post} key={post.id} />)\r\n      }\r\n      {!isGettingPosts\r\n        && (\r\n        <PageControllerContainer>\r\n          <PageController onClick={() => {\r\n            setOffset(0)\r\n            setCurrentPage(1)\r\n          }}\r\n          >\r\n            {\"<<\"}\r\n          </PageController>\r\n          <PageController onClick={() => {\r\n            if (currentPage <= 1) return\r\n            setOffset(offset - 5)\r\n            setCurrentPage(currentPage - 1)\r\n          }}\r\n          >\r\n            {\"<\"}\r\n          </PageController>\r\n\r\n          <CurrentPage>{`${currentPage} / ${totalPageCount}`}</CurrentPage>\r\n\r\n          <PageController onClick={() => {\r\n            if (currentPage >= totalPageCount) return\r\n            setOffset(offset + 5)\r\n            setCurrentPage(currentPage + 1)\r\n          }}\r\n          >\r\n            {\">\"}\r\n          </PageController>\r\n          <PageController onClick={() => {\r\n            setOffset((totalPageCount - 1) * 5)\r\n            setCurrentPage(totalPageCount)\r\n          }}\r\n          >\r\n            {\">>\"}\r\n          </PageController>\r\n        </PageControllerContainer>\r\n        )\r\n      }\r\n    </Root>\r\n  );\r\n}\r\n\r\nexport default HomePage;\r\n","import { useState, useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { register, getMe } from '../../WebAPI'\r\nimport { setAuthToken } from '../../utils'\r\nimport { AuthContext } from '../../contexts';\r\n\r\nconst RegisterForm = styled.form`\r\n  width: 600px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin: 20px auto;\r\n  text-align: center;\r\n`\r\nconst RegisterInputContainer = styled.div`\r\n  & + & {\r\n    margin-top: 10px;\r\n  }\r\n`\r\n\r\nconst ErrorMessage = styled.div`\r\n  font-size: 16px;\r\n  color: red;\r\n`\r\n\r\nconst SubmitButton = styled.button`\r\n  margin-top: 20px;\r\n  padding: 5px 10px;\r\n  width: 60px;\r\n`\r\n\r\nfunction RegisterPage() {\r\n  const [username, setUsername] = useState('')\r\n  const [nickname, setNickname] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n\r\n  const history = useHistory()\r\n\r\n  const { setUser } = useContext(AuthContext)\r\n\r\n  function handleRegisterSubmit(e) {\r\n    e.preventDefault()\r\n    register({\r\n      username,\r\n      nickname,\r\n      password,\r\n    }).then((data) => {\r\n      // Register fail\r\n      if (data.ok === 0) {\r\n        return setErrorMessage(data.message)\r\n      }\r\n\r\n      // Register success\r\n      setErrorMessage(null)\r\n      const { token } = data;\r\n      setAuthToken(token);\r\n      getMe().then((response) => {\r\n        if (response.ok !== 1) {\r\n          setAuthToken(null);\r\n          return setErrorMessage(response.toString());\r\n        }\r\n        setUser(response.data)\r\n        history.push('/')\r\n      })\r\n    })\r\n  }\r\n\r\n  return (\r\n    <RegisterForm onSubmit={handleRegisterSubmit}>\r\n      <h1>註冊</h1>\r\n      <RegisterInputContainer>\r\n        Username:\r\n        <input\r\n          type=\"text\"\r\n          name=\"username\"\r\n          value={username}\r\n          onChange={(e) => {\r\n            setUsername(e.target.value)\r\n          }}\r\n        />\r\n      </RegisterInputContainer>\r\n      <RegisterInputContainer>\r\n        Nickname:\r\n        <input\r\n          type=\"text\"\r\n          name=\"nickname\"\r\n          value={nickname}\r\n          onChange={(e) => {\r\n            setNickname(e.target.value)\r\n          }}\r\n        />\r\n      </RegisterInputContainer>\r\n      <RegisterInputContainer>\r\n        Password:\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          value={password}\r\n          onChange={(e) => {\r\n            setPassword(e.target.value)\r\n          }}\r\n        />\r\n      </RegisterInputContainer>\r\n      {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\r\n      <SubmitButton type=\"submit\">註冊</SubmitButton>\r\n    </RegisterForm>\r\n  );\r\n}\r\n\r\nexport default RegisterPage;\r\n","import { useState, useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { login, getMe } from '../../WebAPI'\r\nimport { setAuthToken } from '../../utils'\r\nimport { AuthContext } from '../../contexts';\r\n\r\nconst LoginForm = styled.form`\r\n  width: 600px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin: 20px auto;\r\n  text-align: center;\r\n`\r\nconst LoginInputContainer = styled.div`\r\n  & + & {\r\n    margin-top: 10px;\r\n  }\r\n`\r\n\r\nconst ErrorMessage = styled.div`\r\n  font-size: 16px;\r\n  color: red;\r\n`\r\n\r\nconst SubmitButton = styled.button`\r\n  margin-top: 20px;\r\n  padding: 5px 10px;\r\n  width: 60px;\r\n`\r\n\r\nfunction LoginPage() {\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n\r\n  const history = useHistory()\r\n\r\n  const { setUser } = useContext(AuthContext)\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault()\r\n    login(username, password)\r\n      .then((data) => {\r\n        // login fail\r\n        if (data.ok === 0) {\r\n          return setErrorMessage(data.message)\r\n        }\r\n\r\n        // login success\r\n        setErrorMessage(null)\r\n        const { token } = data;\r\n        setAuthToken(token);\r\n        getMe().then((response) => {\r\n          if (response.ok !== 1) {\r\n            setAuthToken(null);\r\n            return setErrorMessage(response.toString());\r\n          }\r\n          setUser(response.data)\r\n          history.push('/')\r\n        })\r\n      })\r\n  }\r\n\r\n  return (\r\n    <LoginForm onSubmit={handleSubmit}>\r\n      <h1>登入</h1>\r\n      <LoginInputContainer>\r\n        Username:\r\n        <input\r\n          type=\"text\"\r\n          name=\"username\"\r\n          value={username}\r\n          onChange={(e) => {\r\n            setUsername(e.target.value)\r\n          }}\r\n        />\r\n      </LoginInputContainer>\r\n      <LoginInputContainer>\r\n        Password:\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          value={password}\r\n          onChange={(e) => {\r\n            setPassword(e.target.value)\r\n          }}\r\n        />\r\n      </LoginInputContainer>\r\n      {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\r\n      <SubmitButton type=\"submit\">登入</SubmitButton>\r\n    </LoginForm>\r\n  );\r\n}\r\n\r\nexport default LoginPage;\r\n","import { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { useParams } from \"react-router-dom\";\r\nimport { getPost } from '../../WebAPI';\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\";\r\nimport { cb } from 'react-syntax-highlighter/dist/esm/styles/prism'\r\n\r\n\r\nconst Root = styled.div``\r\nconst PostContainer = styled.div`\r\n  width: 800px;\r\n  margin: 20px auto 0 auto;\r\n  padding: 20px;\r\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\r\n`\r\nconst PostHeader = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n  padding: 20px 0;\r\n`\r\n\r\nconst PostTitle = styled.div`\r\n  font-size: 36px;\r\n  color: #555;\r\n`\r\n\r\nconst PostInfoContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`\r\nconst PostAuthor = styled.div`\r\n  margin: 10px 10px 0 0;\r\n  font-size: 16px;\r\n  color: #aaa;\r\n`\r\n\r\nconst PostTime = styled(PostAuthor)``\r\nconst PostContent = styled.div`\r\n  padding: 20px 0;\r\n  color: #555;\r\n  white-space: pre-wrap;\r\n`\r\n\r\nconst Img = styled.img`\r\n  width: 100%;\r\n`\r\n\r\nconst renderers = {\r\n  code: ({ language, value }) => {\r\n    return <SyntaxHighlighter style={cb} language={\"javascript\"} children={value} />\r\n  },\r\n  image: ({alt, src, title}) => {\r\n    return <Img src={src}/>\r\n  }\r\n}\r\n\r\nfunction PostPage() {\r\n  const [post, setPost] = useState({})\r\n  const [author, setAuthor] = useState(null)\r\n  const { id } = useParams();\r\n\r\n  useEffect(() => {\r\n    getPost(id).then((post) => {\r\n      setPost(post);\r\n      setAuthor(post.user.nickname);\r\n    })\r\n  }, [])\r\n\r\n  return (\r\n    <Root>\r\n      <PostContainer>\r\n        <PostHeader>\r\n          <PostTitle>{post.title}</PostTitle>\r\n          <PostInfoContainer>\r\n            {author && <PostAuthor>{`作者：${author}`}</PostAuthor>}\r\n            <PostTime>{post.createdAt && new Date(post.createdAt).toLocaleString()}</PostTime>\r\n          </PostInfoContainer>\r\n        </PostHeader>\r\n        <PostContent>\r\n          <ReactMarkdown source={post.body} renderers={renderers} />\r\n        </PostContent>\r\n      </PostContainer>\r\n    </Root>\r\n  );\r\n}\r\n\r\nexport default PostPage;\r\n","import { useState } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { addPost } from '../../WebAPI';\r\n\r\nconst Root = styled.div``\r\nconst NewPostContainer = styled.div`\r\n  width: 600px;\r\n  margin: 20px auto 0 auto;\r\n  padding: 20px;\r\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\r\n`\r\n\r\nconst PageTitle = styled.div`\r\n  padding: 20px 0;\r\n  font-size: 36px;\r\n  color: #333;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n`\r\nconst InputTitle = styled.div`\r\n  margin-bottom: 5px;\r\n`\r\nconst NewPostForm = styled.form`\r\n  padding: 20px 0;\r\n`\r\n\r\nconst NewPostTitle = styled.input`\r\n  margin-bottom: 10px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n`\r\n\r\nconst NewPostContent = styled.textarea`\r\n  margin-bottom: 10px;\r\n  width: 100%;\r\n  height: 400px;\r\n  box-sizing: border-box;\r\n  resize: vertical;\r\n`\r\n\r\nconst ErrorMessage = styled.div`\r\n  margin-bottom: 5px;\r\n  font-size: 16px;\r\n  color: red;\r\n`\r\n\r\nconst NewPostSubmitButtonContainer = styled.div`\r\n  text-align: right;\r\n`\r\nconst NewPostSubmitButton = styled.button``\r\n\r\nfunction NewPostPage() {\r\n  const [title, setTitle] = useState('')\r\n  const [content, setContent] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n  const history = useHistory()\r\n\r\n  function handleTitleChange(e) {\r\n    setTitle(e.target.value);\r\n  }\r\n\r\n  function handleContentChange(e) {\r\n    setContent(e.target.value);\r\n  }\r\n\r\n  function handleNewPostSubmit(e) {\r\n    e.preventDefault();\r\n    addPost(title, content).then((response) => {\r\n      if (response.ok === 0) {\r\n        return setErrorMessage(response.message)\r\n      }\r\n      history.push('/')\r\n    })\r\n  }\r\n\r\n  return (\r\n    <Root>\r\n      <NewPostContainer>\r\n        <PageTitle>發布文章</PageTitle>\r\n        <NewPostForm onSubmit={handleNewPostSubmit}>\r\n          <InputTitle>文章標題：</InputTitle>\r\n          <NewPostTitle value={title} onChange={handleTitleChange} />\r\n          <InputTitle>文章內容：</InputTitle>\r\n          <NewPostContent value={content} onChange={handleContentChange} />\r\n          <NewPostSubmitButtonContainer>\r\n            {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\r\n            <NewPostSubmitButton>發布</NewPostSubmitButton>\r\n          </NewPostSubmitButtonContainer>\r\n        </NewPostForm>\r\n      </NewPostContainer>\r\n    </Root>\r\n  );\r\n}\r\n\r\nexport default NewPostPage;\r\n","import styled from 'styled-components';\r\n\r\nconst Root = styled.div``\r\nconst AboutContainer = styled.div`\r\n  width: 600px;\r\n  margin: 20px auto 0 auto;\r\n  padding: 20px;\r\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\r\n`\r\nconst AboutHeader = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n  padding: 20px 0;\r\n`\r\n\r\nconst AboutTitle = styled.div`\r\n  font-size: 36px;\r\n  color: #555;\r\n`\r\n\r\nconst AboutContent = styled.div`\r\n  padding: 20px 0;\r\n  color: #555;\r\n  word-break: break-word;\r\n`\r\n\r\nfunction AboutPage() {\r\n  return (\r\n    <Root>\r\n      <AboutContainer>\r\n        <AboutHeader>\r\n          <AboutTitle>\r\n            About\r\n          </AboutTitle>\r\n        </AboutHeader>\r\n        <AboutContent>\r\n          Lidemy React homework - blog\r\n        </AboutContent>\r\n      </AboutContainer>\r\n    </Root>\r\n  );\r\n}\r\n\r\nexport default AboutPage;\r\n","import { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport {\r\n  HashRouter as Router, Switch, Route,\r\n} from 'react-router-dom';\r\nimport Header from '../Header';\r\nimport HomePage from '../../pages/HomePage';\r\nimport RegisterPage from '../../pages/RegisterPage';\r\nimport LoginPage from '../../pages/LoginPage';\r\nimport PostPage from '../../pages/PostPage';\r\nimport NewPostPage from '../../pages/NewPostPage';\r\nimport AboutPage from '../../pages/AboutPage';\r\n\r\n\r\nimport { AuthContext } from '../../contexts';\r\nimport { getMe } from '../../WebAPI';\r\nimport { getAuthToken } from '../../utils';\r\n\r\nconst Root = styled.div`\r\n  padding-top: 64px;\r\n`;\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n  const [isGettingUser, setIsGettingUser] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (getAuthToken()) {\r\n      getMe().then((response) => {\r\n        if (response.ok) {\r\n          setUser(response.data);\r\n          setIsGettingUser(false);\r\n        }\r\n      });\r\n    } else {\r\n      setIsGettingUser(false);\r\n    }\r\n  }, []);\r\n\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, setUser, isGettingUser }}>\r\n      <Root>\r\n        <Router>\r\n          <Header />\r\n          <Switch>\r\n            <Route exact path=\"/\">\r\n              <HomePage />\r\n            </Route>\r\n            <Route path=\"/register\">\r\n              <RegisterPage />\r\n            </Route>\r\n            <Route path=\"/login\">\r\n              <LoginPage />\r\n            </Route>\r\n            <Route path=\"/posts/:id\">\r\n              <PostPage />\r\n            </Route>\r\n            <Route path=\"/new-post\">\r\n              <NewPostPage />\r\n            </Route>\r\n            <Route path=\"/about\">\r\n              <AboutPage />\r\n            </Route>\r\n          </Switch>\r\n\r\n        </Router>\r\n      </Root>\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\n\r\nexport default App;\r\n","/* eslint-disable react/jsx-filename-extension */\r\n/* eslint-disable import/no-unresolved */\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './components/App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n"],"sourceRoot":""}