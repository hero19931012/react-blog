(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[0],{35:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),i=e.n(c),a=e(20),o=e.n(a),u=e(4),s=e(2),j=e(3),b=e(10),d=e(5),f=Object(c.createContext)(null),l="token",x=function(n){localStorage.setItem(l,n)},O=function(){return localStorage.getItem(l)};function p(){var n=Object(s.a)(["\n  padding: 0 10px;\n  width: 100px;\n  text-align: center;\n  text-decoration: none;\n  cursor: pointer;\n\n  /* &:hover {\n    background-color: #9999aa\n  } */\n\n  ","\n"]);return p=function(){return n},n}function h(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return h=function(){return n},n}function v(){var n=Object(s.a)(["\n  display: flex;\n  height: 100%;\n"]);return v=function(){return n},n}function g(){var n=Object(s.a)(["\n  margin: 0 20px 0 0;\n"]);return g=function(){return n},n}function m(){var n=Object(s.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\n  box-sizing: border-box;\n  padding: 0 32px;\n\n  color: #555;\n  background-color: white;\n\n  /* color: white; */\n  /* background-color: #000035;  */\n  line-height: 64px;\n\n  & * {\n    color: #555;\n    /* border: solid 1px rgba(0, 0, 0, 0.3) */\n  }\n"]);return m=function(){return n},n}var w=j.a.div(m()),y=j.a.h1(g()),k=j.a.div(v()),S=j.a.div(h()),z=Object(j.a)(b.b)(p(),(function(n){return n.$active&&"background: rgba(0, 0, 0, 0.1)"}));var C=function(){var n=Object(d.g)().pathname,t=Object(c.useContext)(f),e=t.user,i=t.setUser,a=t.isGettingUser,o=Object(d.f)();return Object(r.jsxs)(w,{children:[Object(r.jsxs)(k,{children:[Object(r.jsx)(y,{children:"\u90e8\u843d\u683c"}),Object(r.jsxs)(S,{children:[Object(r.jsx)(z,{to:"/",$active:"/"===n,children:"\u9996\u9801"}),Object(r.jsx)(z,{to:"/about",$active:"/about"===n,children:"\u95dc\u65bc"}),!a&&e&&Object(r.jsx)(z,{to:"/new-post",$active:"/new-post"===n,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(S,{children:[!a&&e&&Object(r.jsx)("div",{children:e.username}),!a&&e&&Object(r.jsx)(z,{to:"/",onClick:function(){x(""),o.push("/"),i(null)},children:"\u767b\u51fa"}),!a&&!e&&Object(r.jsx)(z,{to:"/login",$active:"/login"===n,children:"\u767b\u5165"}),!a&&!e&&Object(r.jsx)(z,{to:"/register",$active:"/register"===n,children:"\u8a3b\u518a"})]})]})},U="https://student-json-api.lidemy.me";function P(){var n=O();if(n)return fetch("".concat(U,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()})).catch((function(n){console.log(n)}))}function $(){var n=Object(s.a)(["\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white;\n  font-size: 48px;\n  background: rgba(0, 0, 0, 0.5);\n"]);return $=function(){return n},n}function A(){var n=Object(s.a)(["\n  border: none;\n"]);return A=function(){return n},n}function D(){var n=Object(s.a)([""]);return D=function(){return n},n}function J(){var n=Object(s.a)([""]);return J=function(){return n},n}function E(){var n=Object(s.a)([""]);return E=function(){return n},n}function L(){var n=Object(s.a)([""]);return L=function(){return n},n}function N(){var n=Object(s.a)(["\n  width: 50px;\n  height: 30px;\n  color: #555;;\n  cursor: pointer;\n  text-align: center;\n  line-height: 30px;\n  border: solid 1px #555;\n"]);return N=function(){return n},n}function B(){var n=Object(s.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  & * {\n    margin: 0 10px;\n  }\n"]);return B=function(){return n},n}function I(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.6);\n"]);return I=function(){return n},n}function T(){var n=Object(s.a)(["\n  font-size: 20px;\n  max-width: 360px;\n  overflow: hidden;\n  cursor: pointer;\n  color: #555;\n  text-decoration: none;\n  word-break: break-word;\n"]);return T=function(){return n},n}function _(){var n=Object(s.a)(["\n  margin: 0 auto;\n  padding: 16px;\n  width: 600px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  border-bottom: solid 1px rgba(0, 0, 0, 0.2);\n"]);return _=function(){return n},n}function G(){var n=Object(s.a)([""]);return G=function(){return n},n}var M=j.a.div(G()),R=j.a.div(_()),q=Object(j.a)(b.b)(T()),F=j.a.div(I()),H=j.a.div(B()),K=j.a.div(N()),Q=Object(j.a)(K)(L()),V=Object(j.a)(K)(E()),W=Object(j.a)(K)(J()),X=Object(j.a)(K)(D()),Y=Object(j.a)(K)(A()),Z=j.a.div($());function nn(n){var t=n.post;return Object(r.jsxs)(R,{children:[Object(r.jsx)(q,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(F,{children:new Date(t.createdAt).toLocaleString()})]})}var tn=function(){var n=Object(c.useState)([]),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(0),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(1),d=Object(u.a)(b,2),f=d[0],l=d[1],x=Object(c.useState)(!0),O=Object(u.a)(x,2),p=O[0],h=O[1],v=Math.ceil(e.length/5);return Object(c.useEffect)((function(){fetch("".concat(U,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()})).then((function(n){i(n),h(!1)}))}),[]),Object(r.jsxs)(M,{children:[p&&Object(r.jsx)(Z,{children:"Loading..."}),!p&&e.filter((function(n,t){return t>=s&&t<s+5})).map((function(n){return Object(r.jsx)(nn,{post:n},n.id)})),!p&&Object(r.jsxs)(H,{children:[Object(r.jsx)(Q,{onClick:function(){j(0),l(1)},children:"<<"}),Object(r.jsx)(V,{onClick:function(){f<=1||(j(s-5),l(f-1))},children:"<"}),Object(r.jsx)(Y,{children:"".concat(f," / ").concat(v)}),Object(r.jsx)(W,{onClick:function(){f>=v||(j(s+5),l(f+1))},children:">"}),Object(r.jsx)(X,{onClick:function(){j(5*(v-1)),l(v)},children:">>"})]})]})};function en(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return en=function(){return n},n}function rn(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return rn=function(){return n},n}function cn(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return cn=function(){return n},n}function an(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return an=function(){return n},n}var on=j.a.form(an()),un=j.a.div(cn()),sn=j.a.div(rn()),jn=j.a.button(en());var bn=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),l=Object(u.a)(b,2),O=l[0],p=l[1],h=Object(c.useState)(""),v=Object(u.a)(h,2),g=v[0],m=v[1],w=Object(d.f)(),y=Object(c.useContext)(f).setUser;return Object(r.jsxs)(on,{onSubmit:function(n){n.preventDefault(),function(n){var t=n.username,e=n.nickname,r=n.password;return fetch("".concat(U,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:e,username:t,password:r})}).then((function(n){return n.json()}))}({username:e,nickname:s,password:O}).then((function(n){if(0===n.ok)return m(n.message);m(null),console.log(n);var t=n.token;x(t),P().then((function(n){if(console.log(n),1!==n.ok)return x(null),m(n.toString());y(n.data),w.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u8a3b\u518a"}),Object(r.jsxs)(un,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){i(n.target.value)}})]}),Object(r.jsxs)(un,{children:["Nickname:",Object(r.jsx)("input",{type:"text",name:"nickname",value:s,onChange:function(n){j(n.target.value)}})]}),Object(r.jsxs)(un,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:O,onChange:function(n){p(n.target.value)}})]}),g&&Object(r.jsx)(sn,{children:g}),Object(r.jsx)(jn,{type:"submit",children:"\u8a3b\u518a"})]})};function dn(){var n=Object(s.a)(["\n  margin-top: 20px;\n  padding: 5px 10px;\n  width: 60px;\n"]);return dn=function(){return n},n}function fn(){var n=Object(s.a)(["\n  font-size: 16px;\n  color: red;\n"]);return fn=function(){return n},n}function ln(){var n=Object(s.a)(["\n  & + & {\n    margin-top: 10px;\n  }\n"]);return ln=function(){return n},n}function xn(){var n=Object(s.a)(["\n  width: 600px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 20px auto;\n  text-align: center;\n"]);return xn=function(){return n},n}var On=j.a.form(xn()),pn=j.a.div(ln()),hn=j.a.div(fn()),vn=j.a.button(dn());var gn=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),l=Object(u.a)(b,2),O=l[0],p=l[1],h=Object(d.f)(),v=Object(c.useContext)(f).setUser;return Object(r.jsxs)(On,{onSubmit:function(n){n.preventDefault(),function(n,t){return fetch("".concat(U,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(0===n.ok)return p(n.message);p(null);var t=n.token;x(t),P().then((function(n){if(console.log(n),1!==n.ok)return x(null),p(n.toString());v(n.data),h.push("/")}))}))},children:[Object(r.jsx)("h1",{children:"\u767b\u5165"}),Object(r.jsxs)(pn,{children:["Username:",Object(r.jsx)("input",{type:"text",name:"username",value:e,onChange:function(n){i(n.target.value)}})]}),Object(r.jsxs)(pn,{children:["Password:",Object(r.jsx)("input",{type:"password",name:"password",value:s,onChange:function(n){j(n.target.value)}})]}),O&&Object(r.jsx)(hn,{children:O}),Object(r.jsx)(vn,{type:"submit",children:"\u767b\u5165"})]})};function mn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  word-break: break-word;\n"]);return mn=function(){return n},n}function wn(){var n=Object(s.a)([""]);return wn=function(){return n},n}function yn(){var n=Object(s.a)(["\n  margin: 10px 10px 0 0;\n  font-size: 16px;\n  color: #aaa;\n"]);return yn=function(){return n},n}function kn(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n"]);return kn=function(){return n},n}function Sn(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return Sn=function(){return n},n}function zn(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return zn=function(){return n},n}function Cn(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return Cn=function(){return n},n}function Un(){var n=Object(s.a)([""]);return Un=function(){return n},n}var Pn=j.a.div(Un()),$n=j.a.div(Cn()),An=j.a.div(zn()),Dn=j.a.div(Sn()),Jn=j.a.div(kn()),En=j.a.div(yn()),Ln=Object(j.a)(En)(wn()),Nn=j.a.div(mn());var Bn=function(){var n=Object(c.useState)({}),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(null),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(d.h)().id;return Object(c.useEffect)((function(){(function(n){return fetch("".concat(U,"/posts/").concat(n,"/?_expand=user")).then((function(n){return n.json()}))})(b).then((function(n){i(n),j(n.user.nickname)}))}),[]),Object(r.jsx)(Pn,{children:Object(r.jsxs)($n,{children:[Object(r.jsxs)(An,{children:[Object(r.jsx)(Dn,{children:e.title}),Object(r.jsxs)(Jn,{children:[s&&Object(r.jsx)(En,{children:"\u4f5c\u8005\uff1a".concat(s)}),Object(r.jsx)(Ln,{children:e.createdAt&&new Date(e.createdAt).toLocaleString()})]})]}),Object(r.jsx)(Nn,{children:e.body})]})})};function In(){var n=Object(s.a)([""]);return In=function(){return n},n}function Tn(){var n=Object(s.a)(["\n  text-align: right;\n"]);return Tn=function(){return n},n}function _n(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n  font-size: 16px;\n  color: red;\n"]);return _n=function(){return n},n}function Gn(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  height: 400px;\n  box-sizing: border-box;\n  resize: vertical;\n"]);return Gn=function(){return n},n}function Mn(){var n=Object(s.a)(["\n  margin-bottom: 10px;\n  width: 100%;\n  box-sizing: border-box;\n"]);return Mn=function(){return n},n}function Rn(){var n=Object(s.a)(["\n  padding: 20px 0;\n"]);return Rn=function(){return n},n}function qn(){var n=Object(s.a)(["\n  margin-bottom: 5px;\n"]);return qn=function(){return n},n}function Fn(){var n=Object(s.a)(["\n  padding: 20px 0;\n  font-size: 36px;\n  color: #333;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n"]);return Fn=function(){return n},n}function Hn(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return Hn=function(){return n},n}function Kn(){var n=Object(s.a)([""]);return Kn=function(){return n},n}var Qn=j.a.div(Kn()),Vn=j.a.div(Hn()),Wn=j.a.div(Fn()),Xn=j.a.div(qn()),Yn=j.a.form(Rn()),Zn=j.a.input(Mn()),nt=j.a.textarea(Gn()),tt=j.a.div(_n()),et=j.a.div(Tn()),rt=j.a.button(In());var ct=function(){var n=Object(c.useState)(""),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),f=Object(u.a)(b,2),l=f[0],x=f[1],p=Object(d.f)();return Object(r.jsx)(Qn,{children:Object(r.jsxs)(Vn,{children:[Object(r.jsx)(Wn,{children:"\u767c\u5e03\u6587\u7ae0"}),Object(r.jsxs)(Yn,{onSubmit:function(n){n.preventDefault(),console.log(e,s),function(n,t){var e=O();return fetch("".concat(U,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({title:n,body:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(console.log(n),0===n.ok)return x(n.message);p.push("/")}))},children:[Object(r.jsx)(Xn,{children:"\u6587\u7ae0\u6a19\u984c\uff1a"}),Object(r.jsx)(Zn,{value:e,onChange:function(n){i(n.target.value)}}),Object(r.jsx)(Xn,{children:"\u6587\u7ae0\u5167\u5bb9\uff1a"}),Object(r.jsx)(nt,{value:s,onChange:function(n){j(n.target.value)}}),Object(r.jsxs)(et,{children:[l&&Object(r.jsx)(tt,{children:l}),Object(r.jsx)(rt,{children:"\u767c\u5e03"})]})]})]})})};function it(){var n=Object(s.a)(["\n  padding: 20px 0;\n  color: #555;\n  word-break: break-word;\n"]);return it=function(){return n},n}function at(){var n=Object(s.a)(["\n  font-size: 36px;\n  color: #555;\n"]);return at=function(){return n},n}function ot(){var n=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 20px 0;\n"]);return ot=function(){return n},n}function ut(){var n=Object(s.a)(["\n  width: 600px;\n  margin: 20px auto 0 auto;\n  padding: 20px;\n  box-shadow: 0px 2px 10px 2px rgba(0, 0, 0, 0.1);\n"]);return ut=function(){return n},n}function st(){var n=Object(s.a)([""]);return st=function(){return n},n}var jt=j.a.div(st()),bt=j.a.div(ut()),dt=j.a.div(ot()),ft=j.a.div(at()),lt=j.a.div(it());var xt=function(){return Object(r.jsx)(jt,{children:Object(r.jsxs)(bt,{children:[Object(r.jsx)(dt,{children:Object(r.jsx)(ft,{children:"About"})}),Object(r.jsx)(lt,{children:"Lidemy React homework - blog"})]})})};function Ot(){var n=Object(s.a)(["\n  padding-top: 64px;\n"]);return Ot=function(){return n},n}var pt=j.a.div(Ot());var ht=function(){var n=Object(c.useState)(null),t=Object(u.a)(n,2),e=t[0],i=t[1],a=Object(c.useState)(!0),o=Object(u.a)(a,2),s=o[0],j=o[1];return Object(c.useEffect)((function(){O()?P().then((function(n){n.ok&&(i(n.data),j(!1))})):j(!1)}),[]),Object(r.jsx)(f.Provider,{value:{user:e,setUser:i,isGettingUser:s},children:Object(r.jsx)(pt,{children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(C,{}),Object(r.jsxs)(d.c,{children:[Object(r.jsx)(d.a,{exact:!0,path:"/",children:Object(r.jsx)(tn,{})}),Object(r.jsx)(d.a,{path:"/register",children:Object(r.jsx)(bn,{})}),Object(r.jsx)(d.a,{path:"/login",children:Object(r.jsx)(gn,{})}),Object(r.jsx)(d.a,{path:"/posts/:id",children:Object(r.jsx)(Bn,{})}),Object(r.jsx)(d.a,{path:"/new-post",children:Object(r.jsx)(ct,{})}),Object(r.jsx)(d.a,{path:"/about",children:Object(r.jsx)(xt,{})})]})]})})})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(ht,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.fdcd3067.chunk.js.map